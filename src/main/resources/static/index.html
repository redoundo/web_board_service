<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>자유 게시판 - 목록입니다.</title>
</head>
<body>
<div id="Board">
    <h2>자유 게시판 - 목록입니다.</h2>
    <div>
        <div id="BoardOptDiv">
            <form id="OptForm" method="get" th:action>
                <div id="OptFormSpan">
                    <p id="RegistrationDateText"> 등록일</p>
                    <div id="SetRegisteredDate">
                        <label for="RegisteredDateFrom">
                            <input name="start" id="RegisteredDateFrom" type="date" th:value="${start}"/>
                        </label>
                        <p>~</p>
                        <label for="RegisteredDateEnd">
                            <input name="end" id="RegisteredDateEnd" type="date" th:value="${end}">
                        </label>
                    </div>
                    <span id="SearchOpt" >
            <label for="CategoryOpt">
               <th:block th:object="${categories}" th:if="${categories != null}">
                    <select id="CategoryOpt" name="category"  th:if="${ categories.keySet().size() > 1}"
                            th:each="category : ${categories.keySet().toArray()}">
                        <option value=null>전체 카테고리</option>
                        <option th:value="${category}" th:text="${categories.get(category)}"/>
                    </select>
               </th:block>
                <th:block  th:object="${categories}" th:if="${categories == null}">
                    <select>
                        <option value=null>전체 카테고리</option>
                    </select>
                </th:block>
            </label>
            <label for="KeywordInput">
              <input name="keyword" id="KeywordInput" placeholder="검색어를 입력해주세요.(제목+작성자+내용)"/>
            </label>
          </span>
                </div>
                <input type="submit" value="검색" />
            </form>
        </div>
    </div>
    <th:block th:if="${error != null && error.getStatus() == 400}">
        <script th:inline="javascript">
            /*<![CDATA[*/
            let err = [[${error.errorMessage}]];
            let uri = [[${error.redirectUri}]];
            alert(err);
            /*]]>*/
        </script>
    </th:block>
    <div id='Result'>
        <h6 id='ResultsCount' th:object="${total}" th:text="|총 ${total}건|"></h6>
        <table id='ResultList'>
            <thead>
            <tr>
                <th scope="col"></th>
                <th scope="col">카테고리</th>
                <th scope="col"></th>
                <th scope="col">제목</th>
                <th scope="col">작성자</th>
                <th scope="col">조회수</th>
                <th scope="col">등록일시</th>
                <th scope="col">수정일시</th>
            </tr>
            </thead>
            <tbody th:if="${contents != null}">
            <tr th:each="content : ${contents}">
                <td th:text="${content}"></td>
            </tr>
            </tbody>
            <tbody th:unless="${contents != null}">
            <tr>결과가 존재하지 않습니다.</tr>
            </tbody>
        </table>
    </div>
    <div th:replace="paginantion.html :: pagination"></div>
    <div id="creatContentDiv">
        <button type="button" onclick="goBack('/write.html')">등록</button>
    </div>
</div>
<script th:inline="javascript">
    function goBack( where ){
        let url = window.location.href;
        if(url.includes("?") && url.includes("=")){
            let query = url.split("?")[1];
            return location.href = where + "?" + query;
        } else{
            return location.href = where;
        }
    }
</script>
</body>
</html>